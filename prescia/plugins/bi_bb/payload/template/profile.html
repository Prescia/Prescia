<div class="container">
	
	<div class="panel panel-warning">
		<div class="panel-heading">
			{_LOGGED}
				<a class="pull-right" href="/?logout=true"><spam alt="Logout" class="glyphicon glyphicon-off"></spam></a>
			{/LOGGED}
			<spam class="glyphicon glyphicon-ok"></spam> {_t}profile{/t} {_LOGGED}: {USER_LOGIN}{/LOGGED}
		</div>
		<div class="panel-body">
			
			{CONTENTMAN}
			
			<form class="form-horizontal" action="bbaction.php" id="profileform" method="post" onsubmit="return checkprofile(this)" enctype="multipart/form-data">
			<input type="hidden" name="haveinfo" value="1"/>
			<input type="hidden" name="bbaction" value="profile"/>
			<input type="hidden" name="MAX_FILE_SIZE" value="500000" />
			
			<div class="row">
				<div class="col-md-2 text-right" style="line-height:30px;">{_t}name{/t} <spam class="glyphicon glyphicon-user"></spam></div>
				<div class="col-md-9">
					<div class="form-group has-feedback">
						<input type="text" onblur="fillfeedback(this.form)" class="form-control" placeholder="{_t}name{/t}" value="{name|html}" name="name"/>
						<span class="glyphicon form-control-feedback"></span>
					</div>
				</div>
			</div>
			{_GUEST}
			<div class="row">
				<div class="col-md-2 text-right" style="line-height:30px;">{_t}login{/t} <spam class="glyphicon glyphicon-user"></spam></div>
				<div class="col-md-9">
					<div class="form-group  has-feedback">
						<input type="text" onblur="fillfeedback(this.form)" class="form-control" placeholder="{_t}login{/t}" value="{login}" name="ulogin"/>
						<span class="glyphicon  form-control-feedback"></span>
					</div>
				</div>
			</div>
			{/GUEST}
			<div class="row">
				<div class="col-md-2 text-right" style="line-height:30px;">{_LOGGED}{_t}change_password{/t}{/LOGGED}{_GUEST}{_t}password{/t}{/GUEST} <spam class="glyphicon glyphicon-lock"></spam></div>
				<div class="col-md-9">
					<div class="form-group  has-feedback">
						<input type="password" onblur="fillfeedback(this.form)" class="form-control" placeholder="{_t}password{/t}" value="" name="upassword"/>
						<span class="glyphicon form-control-feedback"></span>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2 text-right" style="line-height:30px;">{_t}repeat_password{/t} <spam class="glyphicon glyphicon-lock"></spam></div>
				<div class="col-md-9">
					<div class="form-group  has-feedback">
						<input type="password" onblur="fillfeedback(this.form)" class="form-control" placeholder="{_t}repeat_password{/t}" value="" name="upassword2"/>
						<span class="glyphicon  form-control-feedback"></span>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2 text-right" style="line-height:30px;">{_t}password{/t} <spam class="glyphicon glyphicon-envelope"></spam></div>
				<div class="col-md-9">
					<div class="form-group  has-feedback">
						<input type="text" onblur="fillfeedback(this.form)" class="form-control" placeholder="{_t}email{/t}" value="{email}" name="email"/>
						<span class="glyphicon  form-control-feedback"></span>
					</div>
				</div>
			</div>
			
			<div class="row">
				<div class="col-md-2 text-right" style="line-height:30px;">{_t}language{/t} <spam class="glyphicon glyphicon-globe"></spam></div>
				<div class="col-md-5" style="line-height:30px;">
					<div class="form-group">
						<select name="lang" class="form-control">
							{langout}
						</select>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2 text-right" style="line-height:30px;">{_t}ipp{/t} <spam class="glyphicon glyphicon-list-alt"></spam></div>
				<div class="col-md-5">
					<div class="form-group has-feedback">
						<input type="text" onblur="fillfeedback(this.form)" class="form-control" placeholder="{_t}ipp{/t}" value="{ipp|onnull|30}" name="ipp"/>
						<span class="glyphicon form-control-feedback"></span>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2 text-right" style="line-height:50px;">{_t}avatar{/t} <spam class="glyphicon glyphicon-picture"></spam></div>
				<div class="col-md-9" style="line-height:50px;">
					<div class="pull-left">
						{_imageyes}<img src="/{image}" alt="User Avatar" class="img-rounded"/>{/imageyes}
						{_imageno}<spam class="glyphicon glyphicon glyphicon-user"></spam>{/imageno}
					</div>
					<input type="file" class="form-control" placeholder="{_t}avatar{/t}" style="margin-left:40px" name="image"/>
				</div>
			</div>
			{_GUEST}
			<div class="row">
				<div class="col-md-2 text-right" style="line-height:30px;">{_t}captcha{/t} <spam class="glyphicon glyphicon-list-alt"></spam></div>
				<div class="col-md-5">
					<div class="form-group has-feedback">
						<input type="text" onblur="fillfeedback(this.form)" class="form-control" placeholder="{_t}captcha{/t}" value="" name="captcha"/>
						<span class="glyphicon form-control-feedback"></span>
					</div>
				</div>
				<div class="col-md-5">
					&laquo; {captcha}
				</div>
			</div>
			{/GUEST}
			<div class="row">
				<div class="col-md-12 text-right" style="line-height:50px;">
					<button type="submit" class="btn btn-primary btn-sm">{_t}save{/t}</button>
				</div>
			</div>
			
			</form>
		</div>
	</div>

	
</div>

<script type='text/javascript'><!--
	
	function fillfeedback(frm) {
		// color/spans
		setSuccess(frm.name,frm.name.value.length > 10?2:(frm.name.value.length > 3?1:0));
		{_GUEST}setSuccess(frm.ulogin,isLogin(frm.ulogin.value)?2:0);
		setSuccess(frm.upassword,isLogin(frm.upassword.value)?(frm.upassword.value==frm.ulogin.value?1:2):0);
		{/GUEST}
		{_LOGGED}
		setSuccess(frm.upassword,frm.upassword.value == '' || isLogin(frm.upassword.value)?(frm.upassword.value=='{USER_LOGIN}'?1:2):0);
		{/LOGGED}
		setSuccess(frm.upassword2,frm.upassword2.value == frm.upassword.value?2:1);
		setSuccess(frm.email,isMail(frm.email.value)?2:0);
		setSuccess(frm.ipp,isnumber(frm.ipp.value,false) && frm.ipp.value>4?(frm.ipp.value>15?2:1):0);
		{_GUEST}setSuccess(frm.captcha,(isnumber(frm.captcha.value,false) && frm.captcha.value.length==4)?2:1);{/GUEST}
		// messages
		var failed = false;
		if (frm.name.value.length<10) {
			if (frm.name.value.length<4) {
				$(frm.name).next('span').prop('title', '{_t}name_too_short{/t}');
				failed = true; 
			} else {
				$(frm.name).next('span').prop('title', '{_t}please_try_larger_name{/t}'); 
			}
		}
		{_GUEST}
		if (!isLogin(frm.ulogin.value)) {
			$(frm.ulogin).next('span').prop('title', '{_t}invalid_login{/t}');
			failed = true;
		}
		if (!isLogin(frm.upassword.value)) {
			$(frm.upassword).next('span').prop('title', '{_t}invalid_password{/t}');
			failed = true;
		} else if (frm.upassword.value == frm.ulogin.value) {
			$(frm.upassword).next('span').prop('title', '{_t}please_set_login_dif_password{/t}');
		}
		{/GUEST}
		{_LOGGED}
		if (!isLogin(frm.upassword.value) && frm.upassword.value != '') {
			$(frm.upassword).next('span').prop('title', '{_t}invalid_password{/t}');
			failed = true;
		} else if (frm.upassword.value == '{USER_LOGIN}') {
			$(frm.upassword).next('span').prop('title', '{_t}please_set_login_dif_password{/t}');
		}
		{/LOGGED}
		if (frm.upassword.value != frm.upassword2.value) {
			failed = true;
			$(frm.upassword2).next('span').prop('title', '{_t}passwords_must_match{/t}');
		}
		if (!isMail(frm.email.value)) {
			$(frm.email).next('span').prop('title', '{_t}invalid_email{/t}');
			failed = true;
		}
		if (!isnumber(frm.ipp.value,false) || frm.ipp.value<5) {
			$(frm.ipp).next('span').prop('title', '{_t}ipp{/t} {_t}must_be_number_larger_4{/t}');
			failed = true;
		} else if (frm.ipp.value < 15) {
			$(frm.ipp).next('span').prop('title', '{_t}ipp{/t} {_t}could_be_larger{/t}');
		}
		{_GUEST}
		if (!isnumber(frm.captcha.value,false) || frm.captcha.value.length != 4) {
			failed = true;
			$(frm.captcha).next('span').prop('title', '{_t}invalid_captcha{/t}');
		}
		{/GUEST}
		return !failed;
	}

	function checkprofile(frm) {
		return fillfeedback(frm);
	}
	
	function setSuccess(el,level) {
		var sp = $(el).next('span');
		sp.removeClass('glyphicon-ok');
		sp.removeClass('glyphicon-warning-sign');
		sp.removeClass('glyphicon-remove');
		if (level !== false) sp.addClass(level==2?'glyphicon-ok':(level==1?'glyphicon-warning-sign':'glyphicon-remove'));
		sp.prop('title', 'ok');
		var pt = $(el).parent();
		pt.removeClass('has-warning');
		pt.removeClass('has-error');
		pt.removeClass('has-success');
		if (level !== false) pt.addClass(level==2?'has-success':(level==1?'has-warning':'has-error'));
	}
	

//--></script>
